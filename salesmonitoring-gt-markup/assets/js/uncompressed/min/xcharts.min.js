!function(){function t(t){return _.chain(_.range(t,10)).reverse().map(function(t){return'g[data-index="'+t+'"]'}).value().join(", ")}function n(t,n){var e=t.getAttribute("class");return(null!==e?e.replace(/color\d+/g,""):"")+" color"+n}function e(t,n){return _.chain(t).pluck("data").flatten().pluck(n).uniq().filter(function(t){return void 0!==t&&null!==t}).value().sort(d3.ascending)}function r(t){var n,e,r=t[0],a=t[1];return r===a&&(e=Math.max(Math.round(r/10),4),r-=e,a+=e),n=a-r,r=r?r-n/10:r,r=t[0]>0?Math.max(r,0):r,a=a?a+n/10:a,a=t[1]<0?Math.min(a,0):a,[r,a]}function a(t,n,e,a){var i,o=_.chain(n).pluck("data").flatten().value();return i={x:d3.extent(o,function(t){return t.x}),y:d3.extent(o,function(t){return t.y})},_.each([e,a],function(n,e){var a,u=e?"y":"x";i[u]=d3.extent(o,function(t){return t[u]}),"ordinal"!==n&&_.each([u+"Min",u+"Max"],function(e,o){"time"!==n&&(a=r(i[u])),t.hasOwnProperty(e)&&null!==t[e]?i[u][o]=t[e]:"time"!==n&&(i[u][o]=a[o])})}),i}function i(){var t=document;return!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function o(t,n,e,r){var a,o=this;return o._options=r=_.defaults(r||{},p),i()===!1?r.unsupported(e):(o._selector=e,o._container=d3.select(e),o._drawSvg(),o._mainStorage={},o._compStorage={},n=_.clone(n),t&&!n.type&&(n.type=t),o.setData(n),d3.select(window).on("resize.for."+e,function(){a&&clearTimeout(a),a=setTimeout(function(){a=null,o._resize()},500)}),void 0)}var o,u={},c={},l={};(function(){var t=this,n=t._,e={},r=Array.prototype,a=Object.prototype,i=Function.prototype,o=r.push,u=r.slice,c=r.concat,l=a.toString,s=a.hasOwnProperty,f=r.forEach,p=r.map,d=r.reduce,y=r.reduceRight,h=r.filter,m=r.every,g=r.some,v=r.indexOf,_=r.lastIndexOf,x=Array.isArray,S=Object.keys,w=i.bind,b=function(t){return t instanceof b?t:this instanceof b?(this._wrapped=t,void 0):new b(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports._=b):t._=b,b.VERSION="1.4.3";var k=b.each=b.forEach=function(t,n,r){if(null!=t)if(f&&t.forEach===f)t.forEach(n,r);else if(t.length===+t.length){for(var a=0,i=t.length;i>a;a++)if(n.call(r,t[a],a,t)===e)return}else for(var o in t)if(b.has(t,o)&&n.call(r,t[o],o,t)===e)return};b.map=b.collect=function(t,n,e){var r=[];return null==t?r:p&&t.map===p?t.map(n,e):(k(t,function(t,a,i){r[r.length]=n.call(e,t,a,i)}),r)};var A="Reduce of empty array with no initial value";b.reduce=b.foldl=b.inject=function(t,n,e,r){var a=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(n=b.bind(n,r)),a?t.reduce(n,e):t.reduce(n);if(k(t,function(t,i,o){a?e=n.call(r,e,t,i,o):(e=t,a=!0)}),!a)throw new TypeError(A);return e},b.reduceRight=b.foldr=function(t,n,e,r){var a=arguments.length>2;if(null==t&&(t=[]),y&&t.reduceRight===y)return r&&(n=b.bind(n,r)),a?t.reduceRight(n,e):t.reduceRight(n);var i=t.length;if(i!==+i){var o=b.keys(t);i=o.length}if(k(t,function(u,c,l){c=o?o[--i]:--i,a?e=n.call(r,e,t[c],c,l):(e=t[c],a=!0)}),!a)throw new TypeError(A);return e},b.find=b.detect=function(t,n,e){var r;return M(t,function(t,a,i){return n.call(e,t,a,i)?(r=t,!0):void 0}),r},b.filter=b.select=function(t,n,e){var r=[];return null==t?r:h&&t.filter===h?t.filter(n,e):(k(t,function(t,a,i){n.call(e,t,a,i)&&(r[r.length]=t)}),r)},b.reject=function(t,n,e){return b.filter(t,function(t,r,a){return!n.call(e,t,r,a)},e)},b.every=b.all=function(t,n,r){n||(n=b.identity);var a=!0;return null==t?a:m&&t.every===m?t.every(n,r):(k(t,function(t,i,o){return(a=a&&n.call(r,t,i,o))?void 0:e}),!!a)};var M=b.some=b.any=function(t,n,r){n||(n=b.identity);var a=!1;return null==t?a:g&&t.some===g?t.some(n,r):(k(t,function(t,i,o){return a||(a=n.call(r,t,i,o))?e:void 0}),!!a)};b.contains=b.include=function(t,n){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(n):M(t,function(t){return t===n})},b.invoke=function(t,n){var e=u.call(arguments,2);return b.map(t,function(t){return(b.isFunction(n)?n:t[n]).apply(t,e)})},b.pluck=function(t,n){return b.map(t,function(t){return t[n]})},b.where=function(t,n){return b.isEmpty(n)?[]:b.filter(t,function(t){for(var e in n)if(n[e]!==t[e])return!1;return!0})},b.max=function(t,n,e){if(!n&&b.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!n&&b.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return k(t,function(t,a,i){var o=n?n.call(e,t,a,i):t;o>=r.computed&&(r={value:t,computed:o})}),r.value},b.min=function(t,n,e){if(!n&&b.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!n&&b.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return k(t,function(t,a,i){var o=n?n.call(e,t,a,i):t;r.computed>o&&(r={value:t,computed:o})}),r.value},b.shuffle=function(t){var n,e=0,r=[];return k(t,function(t){n=b.random(e++),r[e-1]=r[n],r[n]=t}),r};var O=function(t){return b.isFunction(t)?t:function(n){return n[t]}};b.sortBy=function(t,n,e){var r=O(n);return b.pluck(b.map(t,function(t,n,a){return{value:t,index:n,criteria:r.call(e,t,n,a)}}).sort(function(t,n){var e=t.criteria,r=n.criteria;if(e!==r){if(e>r||void 0===e)return 1;if(r>e||void 0===r)return-1}return t.index<n.index?-1:1}),"value")};var D=function(t,n,e,r){var a={},i=O(n||b.identity);return k(t,function(n,o){var u=i.call(e,n,o,t);r(a,u,n)}),a};b.groupBy=function(t,n,e){return D(t,n,e,function(t,n,e){(b.has(t,n)?t[n]:t[n]=[]).push(e)})},b.countBy=function(t,n,e){return D(t,n,e,function(t,n){b.has(t,n)||(t[n]=0),t[n]++})},b.sortedIndex=function(t,n,e,r){e=null==e?b.identity:O(e);for(var a=e.call(r,n),i=0,o=t.length;o>i;){var u=i+o>>>1;a>e.call(r,t[u])?i=u+1:o=u}return i},b.toArray=function(t){return t?b.isArray(t)?u.call(t):t.length===+t.length?b.map(t,b.identity):b.values(t):[]},b.size=function(t){return null==t?0:t.length===+t.length?t.length:b.keys(t).length},b.first=b.head=b.take=function(t,n,e){return null==t?void 0:null==n||e?t[0]:u.call(t,0,n)},b.initial=function(t,n,e){return u.call(t,0,t.length-(null==n||e?1:n))},b.last=function(t,n,e){return null==t?void 0:null==n||e?t[t.length-1]:u.call(t,Math.max(t.length-n,0))},b.rest=b.tail=b.drop=function(t,n,e){return u.call(t,null==n||e?1:n)},b.compact=function(t){return b.filter(t,b.identity)};var P=function(t,n,e){return k(t,function(t){b.isArray(t)?n?o.apply(e,t):P(t,n,e):e.push(t)}),e};b.flatten=function(t,n){return P(t,n,[])},b.without=function(t){return b.difference(t,u.call(arguments,1))},b.uniq=b.unique=function(t,n,e,r){b.isFunction(n)&&(r=e,e=n,n=!1);var a=e?b.map(t,e,r):t,i=[],o=[];return k(a,function(e,r){(n?r&&o[o.length-1]===e:b.contains(o,e))||(o.push(e),i.push(t[r]))}),i},b.union=function(){return b.uniq(c.apply(r,arguments))},b.intersection=function(t){var n=u.call(arguments,1);return b.filter(b.uniq(t),function(t){return b.every(n,function(n){return b.indexOf(n,t)>=0})})},b.difference=function(t){var n=c.apply(r,u.call(arguments,1));return b.filter(t,function(t){return!b.contains(n,t)})},b.zip=function(){for(var t=u.call(arguments),n=b.max(b.pluck(t,"length")),e=Array(n),r=0;n>r;r++)e[r]=b.pluck(t,""+r);return e},b.object=function(t,n){if(null==t)return{};for(var e={},r=0,a=t.length;a>r;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e},b.indexOf=function(t,n,e){if(null==t)return-1;var r=0,a=t.length;if(e){if("number"!=typeof e)return r=b.sortedIndex(t,n),t[r]===n?r:-1;r=0>e?Math.max(0,a+e):e}if(v&&t.indexOf===v)return t.indexOf(n,e);for(;a>r;r++)if(t[r]===n)return r;return-1},b.lastIndexOf=function(t,n,e){if(null==t)return-1;var r=null!=e;if(_&&t.lastIndexOf===_)return r?t.lastIndexOf(n,e):t.lastIndexOf(n);for(var a=r?e:t.length;a--;)if(t[a]===n)return a;return-1},b.range=function(t,n,e){1>=arguments.length&&(n=t||0,t=0),e=arguments[2]||1;for(var r=Math.max(Math.ceil((n-t)/e),0),a=0,i=Array(r);r>a;)i[a++]=t,t+=e;return i};var j=function(){};b.bind=function(t,n){var e,r;if(t.bind===w&&w)return w.apply(t,u.call(arguments,1));if(!b.isFunction(t))throw new TypeError;return e=u.call(arguments,2),r=function(){if(!(this instanceof r))return t.apply(n,e.concat(u.call(arguments)));j.prototype=t.prototype;var a=new j;j.prototype=null;var i=t.apply(a,e.concat(u.call(arguments)));return Object(i)===i?i:a}},b.bindAll=function(t){var n=u.call(arguments,1);return 0==n.length&&(n=b.functions(t)),k(n,function(n){t[n]=b.bind(t[n],t)}),t},b.memoize=function(t,n){var e={};return n||(n=b.identity),function(){var r=n.apply(this,arguments);return b.has(e,r)?e[r]:e[r]=t.apply(this,arguments)}},b.delay=function(t,n){var e=u.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},n)},b.defer=function(t){return b.delay.apply(b,[t,1].concat(u.call(arguments,1)))},b.throttle=function(t,n){var e,r,a,i,o=0,u=function(){o=new Date,a=null,i=t.apply(e,r)};return function(){var c=new Date,l=n-(c-o);return e=this,r=arguments,0>=l?(clearTimeout(a),a=null,o=c,i=t.apply(e,r)):a||(a=setTimeout(u,l)),i}},b.debounce=function(t,n,e){var r,a;return function(){var i=this,o=arguments,u=function(){r=null,e||(a=t.apply(i,o))},c=e&&!r;return clearTimeout(r),r=setTimeout(u,n),c&&(a=t.apply(i,o)),a}},b.once=function(t){var n,e=!1;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},b.wrap=function(t,n){return function(){var e=[t];return o.apply(e,arguments),n.apply(this,e)}},b.compose=function(){var t=arguments;return function(){for(var n=arguments,e=t.length-1;e>=0;e--)n=[t[e].apply(this,n)];return n[0]}},b.after=function(t,n){return 0>=t?n():function(){return 1>--t?n.apply(this,arguments):void 0}},b.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var n=[];for(var e in t)b.has(t,e)&&(n[n.length]=e);return n},b.values=function(t){var n=[];for(var e in t)b.has(t,e)&&n.push(t[e]);return n},b.pairs=function(t){var n=[];for(var e in t)b.has(t,e)&&n.push([e,t[e]]);return n},b.invert=function(t){var n={};for(var e in t)b.has(t,e)&&(n[t[e]]=e);return n},b.functions=b.methods=function(t){var n=[];for(var e in t)b.isFunction(t[e])&&n.push(e);return n.sort()},b.extend=function(t){return k(u.call(arguments,1),function(n){if(n)for(var e in n)t[e]=n[e]}),t},b.pick=function(t){var n={},e=c.apply(r,u.call(arguments,1));return k(e,function(e){e in t&&(n[e]=t[e])}),n},b.omit=function(t){var n={},e=c.apply(r,u.call(arguments,1));for(var a in t)b.contains(e,a)||(n[a]=t[a]);return n},b.defaults=function(t){return k(u.call(arguments,1),function(n){if(n)for(var e in n)null==t[e]&&(t[e]=n[e])}),t},b.clone=function(t){return b.isObject(t)?b.isArray(t)?t.slice():b.extend({},t):t},b.tap=function(t,n){return n(t),t};var F=function(t,n,e,r){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof b&&(t=t._wrapped),n instanceof b&&(n=n._wrapped);var a=l.call(t);if(a!=l.call(n))return!1;switch(a){case"[object String]":return t==n+"";case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=typeof t||"object"!=typeof n)return!1;for(var i=e.length;i--;)if(e[i]==t)return r[i]==n;e.push(t),r.push(n);var o=0,u=!0;if("[object Array]"==a){if(o=t.length,u=o==n.length)for(;o--&&(u=F(t[o],n[o],e,r)););}else{var c=t.constructor,s=n.constructor;if(c!==s&&!(b.isFunction(c)&&c instanceof c&&b.isFunction(s)&&s instanceof s))return!1;for(var f in t)if(b.has(t,f)&&(o++,!(u=b.has(n,f)&&F(t[f],n[f],e,r))))break;if(u){for(f in n)if(b.has(n,f)&&!o--)break;u=!o}}return e.pop(),r.pop(),u};b.isEqual=function(t,n){return F(t,n,[],[])},b.isEmpty=function(t){if(null==t)return!0;if(b.isArray(t)||b.isString(t))return 0===t.length;for(var n in t)if(b.has(t,n))return!1;return!0},b.isElement=function(t){return!(!t||1!==t.nodeType)},b.isArray=x||function(t){return"[object Array]"==l.call(t)},b.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){b["is"+t]=function(n){return l.call(n)=="[object "+t+"]"}}),b.isArguments(arguments)||(b.isArguments=function(t){return!(!t||!b.has(t,"callee"))}),b.isFunction=function(t){return"function"==typeof t},b.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},b.isNaN=function(t){return b.isNumber(t)&&t!=+t},b.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},b.isNull=function(t){return null===t},b.isUndefined=function(t){return void 0===t},b.has=function(t,n){return s.call(t,n)},b.noConflict=function(){return t._=n,this},b.identity=function(t){return t},b.times=function(t,n,e){for(var r=Array(t),a=0;t>a;a++)r[a]=n.call(e,a);return r},b.random=function(t,n){return null==n&&(n=t,t=0),t+(0|Math.random()*(n-t+1))};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};T.unescape=b.invert(T.escape);var N={escape:RegExp("["+b.keys(T.escape).join("")+"]","g"),unescape:RegExp("("+b.keys(T.unescape).join("|")+")","g")};b.each(["escape","unescape"],function(t){b[t]=function(n){return null==n?"":(""+n).replace(N[t],function(n){return T[t][n]})}}),b.result=function(t,n){if(null==t)return null;var e=t[n];return b.isFunction(e)?e.call(t):e},b.mixin=function(t){k(b.functions(t),function(n){var e=b[n]=t[n];b.prototype[n]=function(){var t=[this._wrapped];return o.apply(t,arguments),I.call(this,e.apply(b,t))}})};var R=0;b.uniqueId=function(t){var n=""+ ++R;return t?t+n:n},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,E={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;b.template=function(t,n,e){e=b.defaults({},e,b.templateSettings);var r=RegExp([(e.escape||C).source,(e.interpolate||C).source,(e.evaluate||C).source].join("|")+"|$","g"),a=0,i="__p+='";t.replace(r,function(n,e,r,o,u){return i+=t.slice(a,u).replace(B,function(t){return"\\"+E[t]}),e&&(i+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),r&&(i+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(i+="';\n"+o+"\n__p+='"),a=u+n.length,n}),i+="';\n",e.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=Function(e.variable||"obj","_",i)}catch(u){throw u.source=i,u}if(n)return o(n,b);var c=function(t){return o.call(this,t,b)};return c.source="function("+(e.variable||"obj")+"){\n"+i+"}",c},b.chain=function(t){return b(t).chain()};var I=function(t){return this._chain?b(t).chain():t};b.mixin(b),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=r[t];b.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],I.call(this,e)}}),k(["concat","join","slice"],function(t){var n=r[t];b.prototype[t]=function(){return I.call(this,n.apply(this._wrapped,arguments))}}),b.extend(b.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),l={getInsertionPoint:t,colorClass:n};var s=.25;c.ordinal=function(t,n,r){var a=e(t,n);return d3.scale.ordinal().domain(a).rangeRoundBands(r,s)},c.linear=function(t,n,e,r){return d3.scale.linear().domain(r).nice().rangeRound(e)},c.exponential=function(t,n,e,r){return d3.scale.pow().exponent(.65).domain(r).nice().rangeRound(e)},c.time=function(t,n,e,r){return d3.time.scale().domain(_.map(r,function(t){return new Date(t)})).range(e)},c.xy=function(t,n,e,r){var i=t._options,u=a(i,n,e,r),c={},l=[i.axisPaddingLeft,t._width],s=[t._height,i.axisPaddingTop];return _.each([e,r],function(t,e){var r=0===e?"x":"y",a=0===e?l:s,i=o.getScale(t);c[r]=i(n,r,a,u[r])}),c},function(){function t(t,n,e){t.xScale2=d3.scale.ordinal().domain(d3.range(0,e.length)).rangeRoundBands([0,t.xScale.rangeBand()],.08)}function n(t,n,e,r,a){var u,s,f=t.yZero;u=t._g.selectAll(o+e).data(r,function(t){return t.className}),u.enter().insert("g",c).attr("data-index",i).style("opacity",0).attr("class",function(t,n){var r=_.uniq((e+t.className).split(".")).join(" ");return r+" bar "+l.colorClass(this,n)}).attr("transform",function(n,e){return"translate("+t.xScale2(e)+",0)"}),s=u.selectAll("rect").data(function(t){return t.data},function(t){return t.x}),s.enter().append("rect").attr("width",0).attr("rx",3).attr("ry",3).attr("x",function(n){return t.xScale(n.x)+t.xScale2.rangeBand()/2}).attr("height",function(n){return Math.abs(f-t.yScale(n.y))}).attr("y",function(n){return n.y<0?f:t.yScale(n.y)}).on("mouseover",a.mouseover).on("mouseout",a.mouseout).on("click",a.click),n.barGroups=u,n.bars=s}function e(t,n,e){var r=t.yZero;n.barGroups.attr("class",function(t,n){return l.colorClass(this,n)}).transition().duration(e).style("opacity",1).attr("transform",function(n,e){return"translate("+t.xScale2(e)+",0)"}),n.bars.transition().duration(e).attr("width",t.xScale2.rangeBand()).attr("x",function(n){return t.xScale(n.x)}).attr("height",function(n){return Math.abs(r-t.yScale(n.y))}).attr("y",function(n){return n.y<0?r:t.yScale(n.y)})}function r(t,n,e){n.bars.exit().transition().duration(e).attr("width",0).remove(),n.barGroups.exit().transition().duration(e).style("opacity",0).remove()}function a(t,n,e){var r=t.xScale2?t.xScale2.rangeBand()/2:0;delete t.xScale2,n.bars.transition().duration(e).attr("width",0).attr("x",function(n){return t.xScale(n.x)+r})}var i=2,o="g.bar",c=l.getInsertionPoint(i);u.bar={postUpdateScale:t,enter:n,update:e,exit:r,destroy:a}}(),function(){function t(t,n,e,r){function u(t){return[t.data]}var c,s,f,p=t._options.interpolation,d=function(n){return t.xScale2||t.xScale.rangeBand?t.xScale(n.x)+t.xScale.rangeBand()/2:t.xScale(n.x)},y=function(n){return t.yScale(n.y)},h=d3.svg.line().x(d).interpolate(p),m=d3.svg.area().x(d).y1(t.yZero).interpolate(p);c=t._g.selectAll(i+e).data(r,function(t){return t.className}),c.enter().insert("g",o).attr("data-index",a).attr("class",function(t,n){var r=_.uniq((e+t.className).split(".")).join(" ");return r+" line "+l.colorClass(this,n)}),s=c.selectAll("path.fill").data(u),s.enter().append("path").attr("class","fill").style("opacity",0).attr("d",m.y0(y)),f=c.selectAll("path.line").data(u),f.enter().append("path").attr("class","line").style("opacity",0).attr("d",h.y(y)),n.lineContainers=c,n.lineFills=s,n.linePaths=f,n.lineX=d,n.lineY=y,n.lineA=m,n.line=h}function n(t,n,e){n.lineContainers.attr("class",function(t,n){return l.colorClass(this,n)}),n.lineFills.transition().duration(e).style("opacity",1).attr("d",n.lineA.y0(n.lineY)),n.linePaths.transition().duration(e).style("opacity",1).attr("d",n.line.y(n.lineY))}function e(t,n){n.linePaths.exit().style("opacity",0).remove(),n.lineFills.exit().style("opacity",0).remove(),n.lineContainers.exit().remove()}function r(t,n,e){n.linePaths.transition().duration(e).style("opacity",0),n.lineFills.transition().duration(e).style("opacity",0)}var a=3,i="g.line",o=l.getInsertionPoint(a);u.line={enter:t,update:n,exit:e,destroy:r}}(),function(){function t(t,n,e,r,i){var o;a.enter(t,n,e,r,i),o=n.lineContainers.selectAll("circle").data(function(t){return t.data},function(t){return t.x}),o.enter().append("circle").style("opacity",0).attr("cx",n.lineX).attr("cy",n.lineY).attr("r",5).on("mouseover",i.mouseover).on("mouseout",i.mouseout).on("click",i.click),n.lineCircles=o}function n(t,n,e){a.update.apply(null,_.toArray(arguments)),n.lineCircles.transition().duration(e).style("opacity",1).attr("cx",n.lineX).attr("cy",n.lineY)}function e(t,n){n.lineCircles.exit().remove(),a.exit.apply(null,_.toArray(arguments))}function r(t,n,e){a.destroy.apply(null,_.toArray(arguments)),n.lineCircles&&n.lineCircles.transition().duration(e).style("opacity",0)}var a=u.line;u["line-dotted"]={enter:t,update:n,exit:e,destroy:r}}(),function(){function t(t,n,e,r,a){i.enter(t,n,e,r,a)}function n(t){function n(t,n){return t+n.y}var e=_.map(t,function(t){var e=t.data.length,r=_.clone(t.data);for(t=_.clone(t);e;)e-=1,r[e]=_.clone(t.data[e]),r[e].y0=t.data[e].y,r[e].y=_.reduce(_.first(t.data,e),n,t.data[e].y);return _.extend(t,{data:r})});return e}function e(t){t.hasOwnProperty("cumulativeOMainData")&&(t._mainData=t.cumulativeOMainData,delete t.cumulativeOMainData,t._compData=t.cumulativeOCompData,delete t.cumulativeOCompData)}function r(t){e(t),t.cumulativeOMainData=t._mainData,t._mainData=n(t._mainData),t.cumulativeOCompData=t._compData,t._compData=n(t._compData)}function a(t){e(t),i.destroy.apply(null,_.toArray(arguments))}var i=u["line-dotted"];u.cumulative={preUpdateScale:r,enter:t,update:i.update,exit:i.exit,destroy:a}}();var f=[[]],p={mouseover:function(){},mouseout:function(){},click:function(){},axisPaddingTop:0,axisPaddingRight:0,axisPaddingBottom:5,axisPaddingLeft:20,paddingTop:0,paddingRight:0,paddingBottom:20,paddingLeft:60,tickHintX:10,tickFormatX:function(t){return t},tickHintY:10,tickFormatY:function(t){return t},xMin:null,xMax:null,yMin:null,yMax:null,dataFormatX:function(t){return t},dataFormatY:function(t){return t},unsupported:function(t){d3.select(t).text("SVG is not supported on your browser")},empty:function(){},notempty:function(){},timing:750,interpolation:"monotone",sortX:function(t,n){return t.x||n.x?t.x<n.x?-1:1:0}};return o.setVis=function(t,n){if(u.hasOwnProperty(t))throw'Cannot override vis type "'+t+'".';u[t]=n},o.getVis=function(t){if(!u.hasOwnProperty(t))throw'Vis type "'+t+'" does not exist.';return _.clone(u[t])},o.setScale=function(t,n){if(c.hasOwnProperty(t))throw'Scale type "'+t+'" already exists.';c[t]=n},o.getScale=function(t){if(!c.hasOwnProperty(t))throw'Scale type "'+t+'" does not exist.';return c[t]},o.visutils=l,_.defaults(o.prototype,{setType:function(t,n){var e=this;if(!e._type||t!==e._type){if(!u.hasOwnProperty(t))throw'Vis type "'+t+'" is not defined.';e._type&&e._destroy(e._vis,e._mainStorage),e._type=t,e._vis=u[t],n||e._draw()}},setData:function(t){function n(t){var n=_.map(_.clone(t.data),function(t){var n=_.clone(t);return t.hasOwnProperty("x")&&(n.x=r.dataFormatX(t.x)),t.hasOwnProperty("y")&&(n.y=r.dataFormatY(t.y)),n}).sort(r.sortX);return _.extend(_.clone(t),{data:n})}var e=this,r=e._options,a=_.clone(t);if(!t.hasOwnProperty("main"))throw'No "main" key found in given chart data.';switch(t.type){case"bar":t.xScale="ordinal";break;case void 0:t.type=e._type}r.xMin=isNaN(parseInt(t.xMin,10))?r.xMin:t.xMin,r.xMax=isNaN(parseInt(t.xMax,10))?r.xMax:t.xMax,r.yMin=isNaN(parseInt(t.yMin,10))?r.yMin:t.yMin,r.yMax=isNaN(parseInt(t.yMax,10))?r.yMax:t.yMax,e._vis&&e._destroy(e._vis,e._mainStorage),e.setType(t.type,!0),a.main=_.map(a.main,n),e._mainData=a.main,e._xScaleType=a.xScale,e._yScaleType=a.yScale,a.hasOwnProperty("comp")?(a.comp=_.map(a.comp,n),e._compData=a.comp):e._compData=[],e._draw()},setScale:function(t,n){var e=this;switch(t){case"x":e._xScaleType=n;break;case"y":e._yScaleType=n;break;default:throw'Cannot change scale of unknown axis "'+t+'".'}e._draw()},_drawSvg:function(){var t,n,e,r=this,a=r._container,i=r._options,o=parseInt(a.style("width").replace("px",""),10),u=parseInt(a.style("height").replace("px",""),10);t=a.selectAll("svg").data(f),t.enter().append("svg").attr("height",u).attr("width",o).attr("class","xchart"),t.transition().attr("width",o).attr("height",u),n=t.selectAll("g").data(f),n.enter().append("g").attr("transform","translate("+i.paddingLeft+","+i.paddingTop+")"),e=n.selectAll("g.scale").data(f),e.enter().append("g").attr("class","scale"),r._svg=t,r._g=n,r._gScale=e,r._height=u-i.paddingTop-i.paddingBottom-i.axisPaddingTop-i.axisPaddingBottom,r._width=o-i.paddingLeft-i.paddingRight-i.axisPaddingLeft-i.axisPaddingRight},_resize:function(){var t=this;t._drawSvg(),t._draw()},_drawAxes:function(){if(!this._noData){var t,n,e,r,a,i,o,u=this,c=u._options,l=u._gScale.transition().duration(c.timing),s=c.tickHintX,p=c.tickHintY,d=u._height+c.axisPaddingTop+c.axisPaddingBottom;d3.svg.line().x(function(t){return t}),r=d3.svg.axis().scale(u.xScale).ticks(s).tickSize(-u._height).tickFormat(c.tickFormatX).orient("bottom"),e=u._gScale.selectAll("g.axisX").data(f),e.enter().append("g").attr("class","axis axisX").attr("transform","translate(0,"+d+")"),e.call(r),o=u._gScale.selectAll(".axisX g")[0],o.length>u._width/80&&(o.sort(function(t,n){var e=/translate\(([^,)]+)/;return t=t.getAttribute("transform").match(e),n=n.getAttribute("transform").match(e),parseFloat(t[1],10)-parseFloat(n[1],10)}),d3.selectAll(o).filter(function(t,n){return n%(Math.ceil(o.length/s)+1)}).remove()),i=d3.svg.axis().scale(u.yScale).ticks(p).tickSize(-u._width-c.axisPaddingRight-c.axisPaddingLeft).tickFormat(c.tickFormatY).orient("left"),a=u._gScale.selectAll("g.axisY").data(f),a.enter().append("g").attr("class","axis axisY").attr("transform","translate(0,0)"),l.selectAll("g.axisY").call(i),t=u._gScale.selectAll("g.axisZero").data([[]]),t.enter().append("g").attr("class","axisZero"),n=t.selectAll("line").data([[]]),n.enter().append("line").attr("x1",0).attr("x2",u._width+c.axisPaddingLeft+c.axisPaddingRight).attr("y1",u.yZero).attr("y2",u.yZero),n.transition().duration(c.timing).attr("y1",u.yZero).attr("y2",u.yZero)}},_updateScale:function(){var t,n,e=this,r=function(){return _.union(e._mainData,e._compData)},a=r(),i=e._vis;delete e.xScale,delete e.yScale,delete e.yZero,i.hasOwnProperty("preUpdateScale")&&i.preUpdateScale(e,a,e._mainData,e._compData),a=r(),t=c.xy(e,a,e._xScaleType,e._yScaleType),e.xScale=t.x,e.yScale=t.y,n=e.yScale.domain()[0],e.yZero=n>0?e.yScale(n):e.yScale(0),i.hasOwnProperty("postUpdateScale")&&i.postUpdateScale(e,a,e._mainData,e._compData)},_enter:function(t,n,e,r){var a=this,i={click:a._options.click,mouseover:a._options.mouseover,mouseout:a._options.mouseout};a._checkVisMethod(t,"enter"),t.enter(a,n,r,e,i)},_update:function(t,n){var e=this;e._checkVisMethod(t,"update"),t.update(e,n,e._options.timing)},_exit:function(t,n){var e=this;e._checkVisMethod(t,"exit"),t.exit(e,n,e._options.timing)},_destroy:function(t,n){var e=this;e._checkVisMethod(t,"destroy");try{t.destroy(e,n,e._options.timing)}catch(r){}},_draw:function(){var t,n,e=this,r=e._options;e._noData=0===_.flatten(_.pluck(e._mainData,"data").concat(_.pluck(e._compData,"data"))).length,e._updateScale(),e._drawAxes(),e._enter(e._vis,e._mainStorage,e._mainData,".main"),e._exit(e._vis,e._mainStorage),e._update(e._vis,e._mainStorage),t=_.chain(e._compData).groupBy(function(t){return t.type}),n=t.keys(),_.each(e._compStorage,function(t,r){if(-1===n.indexOf(r).value()){var a=u[r];e._enter(a,t,[],".comp."+r.replace(/\W+/g,"")),e._exit(a,t)}}),t.each(function(t,n){var r,a=u[n];e._compStorage.hasOwnProperty(n)||(e._compStorage[n]={}),r=e._compStorage[n],e._enter(a,r,t,".comp."+n.replace(/\W+/g,"")),e._exit(a,r),e._update(a,r)}),e._noData?r.empty(e,e._selector,e._mainData):r.notempty(e,e._selector)},_checkVisMethod:function(t,n){var e=this;if(!t[n])throw'Required method "'+n+'" not found on vis type "'+e._type+'".'}}),"function"==typeof define&&define.amd&&"object"==typeof define.amd?(define(function(){return o}),void 0):(window.xChart=o,void 0)}();